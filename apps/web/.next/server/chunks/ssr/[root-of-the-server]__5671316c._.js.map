{"version":3,"sources":["../../../../../../apps/web/components/app/leaderboard/LeaderboardTable.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/app/%28app%29/leaderboard/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LeaderboardTable = registerClientReference(\n    function() { throw new Error(\"Attempted to call LeaderboardTable() from the server but LeaderboardTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/components/app/leaderboard/LeaderboardTable.tsx\",\n    \"LeaderboardTable\",\n);\n","import { createClient } from \"@/lib/supabase/server\";\nimport { LeaderboardTable } from \"@/components/app/leaderboard/LeaderboardTable\";\nimport type { Metadata } from \"next\";\n\nexport const metadata: Metadata = { title: \"Leaderboard\" };\n\nexport default async function LeaderboardPage({\n  searchParams,\n}: {\n  searchParams: Promise<{ period?: string; region?: string }>;\n}) {\n  const { period = \"week\", region } = await searchParams;\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  // Fetch leaderboard data from API\n  const params = new URLSearchParams({ period, limit: \"50\" });\n  if (region) params.set(\"region\", region);\n\n  // We'll use the materialized view directly for SSR\n  const viewName = `leaderboard_${period === \"all_time\" ? \"all_time\" : period === \"month\" ? \"monthly\" : period === \"day\" ? \"daily\" : \"weekly\"}`;\n\n  let query = supabase\n    .from(viewName)\n    .select(\"*\")\n    .order(\"total_cost\", { ascending: false })\n    .limit(50);\n\n  if (region) {\n    query = query.eq(\"region\", region);\n  }\n\n  const { data: entries } = await query;\n\n  // Get current user's profile for highlighting\n  const { data: profile } = await supabase\n    .from(\"users\")\n    .select(\"country, region\")\n    .eq(\"id\", user!.id)\n    .single();\n\n  // Add rank numbers\n  const ranked =\n    entries?.map((e, i) => ({\n      ...e,\n      rank: i + 1,\n      total_cost: Number(e.total_cost),\n      total_tokens: Number(e.total_tokens),\n    })) ?? [];\n\n  return (\n    <>\n      <header className=\"sticky top-0 z-10 flex h-16 items-center border-b border-border bg-background px-6\">\n        <h3 className=\"text-lg font-medium\">Leaderboard</h3>\n      </header>\n\n      <LeaderboardTable\n        entries={ranked}\n        currentUserId={user!.id}\n        currentPeriod={period}\n        currentRegion={region ?? null}\n        userCountry={profile?.country ?? null}\n      />\n    </>\n  );\n}\n"],"names":[],"mappings":"+XAEO,IAAM,EAAmB,CAAA,EAAA,AADhC,EAAA,CAAA,CAAA,OACgC,uBAAA,AAAuB,EACnD,WAAa,MAAM,AAAI,MAAM,8OAAgP,EAC7Q,yFACA,4EAHG,IAAM,EAAmB,CAAA,EADhC,AACgC,EADhC,CAAA,CAAA,OACgC,uBAAuB,AAAvB,EAC5B,WAAa,MAAM,AAAI,MAAM,8OAAgP,EAC7Q,qEACA,uHCLJ,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MAKe,eAAe,EAAgB,cAC5C,CAAY,CAGb,EACC,GAAM,QAAE,EAAS,MAAM,QAAE,CAAM,CAAE,CAAG,MAAM,EACpC,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,CACJ,KAAM,CAAE,MAAI,CAAE,CACf,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,GAGzB,EAAS,IAAI,gBAAgB,QAAE,EAAQ,MAAO,IAAK,GACrD,GAAQ,EAAO,GAAG,CAAC,SAAU,GAGjC,IAAM,EAAW,CAAC,YAAY,EAAa,aAAX,EAAwB,WAAa,AAAW,YAAU,UAAuB,QAAX,EAAmB,QAAU,SAAA,CAAU,CAEzI,EAAQ,EACT,IAAI,CAAC,GACL,MAAM,CAAC,KACP,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GACvC,KAAK,CAAC,IAEL,GACF,GAAQ,EADE,AACI,EAAE,CAAC,SAAU,EAAA,EAG7B,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAG1B,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC7B,IAAI,CAAC,SACL,MAAM,CAAC,mBACP,EAAE,CAAC,KAAM,EAAM,EAAE,EACjB,MAAM,GAGH,EACJ,GAAS,IAAI,CAAC,EAAG,IAAM,AAAC,EACtB,GAAG,CAAC,CACJ,KAAM,EAAI,EACV,WAAY,OAAO,EAAE,UAAU,EAC/B,aAAc,OAAO,EAAE,YAAY,EACrC,CAAC,GAAM,EAAE,CAEX,MACE,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,8FAChB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+BAAsB,kBAGtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CACf,QAAS,EACT,cAAe,EAAM,EAAE,CACvB,cAAe,EACf,cAAe,GAAU,KACzB,YAAa,GAAS,SAAW,SAIzC,mCA/DkC,CAAE,MAAO,aAAc","ignoreList":[0]}