module.exports=[23326,a=>{"use strict";let b=(0,a.i(98170).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["X",()=>b],23326)},3288,a=>{"use strict";var b=a.i(63291),c=a.i(3252),d=a.i(37503);let e={primary:"bg-accent text-white border-none hover:brightness-90 active:brightness-85 disabled:opacity-50",secondary:"bg-transparent text-foreground border border-border hover:bg-subtle disabled:opacity-50",ghost:"bg-transparent text-foreground border-none hover:text-accent disabled:opacity-50"},f={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},g=(0,c.forwardRef)(({variant:a="primary",size:c="md",className:g,...h},i)=>(0,b.jsx)("button",{ref:i,className:(0,d.cn)("inline-flex items-center justify-center rounded-[4px] font-semibold cursor-pointer transition-[filter,background-color,color] duration-150",e[a],f[c],g),...h}));g.displayName="Button",a.s(["Button",0,g])},28546,a=>{"use strict";var b=a.i(63291),c=a.i(3252),d=a.i(37503);let e=(0,c.forwardRef)(({error:a,className:c,...e},f)=>(0,b.jsx)("textarea",{ref:f,className:(0,d.cn)("w-full rounded-[4px] border bg-white px-4 py-3 text-base text-foreground placeholder:text-muted outline-none transition-[border-color,box-shadow] duration-150 resize-y min-h-[100px]",a?"border-error":"border-border focus:border-accent focus:ring-3 focus:ring-accent/15",c),...e}));e.displayName="Textarea",a.s(["Textarea",0,e])},72349,a=>{"use strict";var b=a.i(63291),c=a.i(3252),d=a.i(37503);let e=(0,c.forwardRef)(({error:a,className:c,...e},f)=>(0,b.jsx)("input",{ref:f,className:(0,d.cn)("w-full rounded-[4px] border bg-white px-4 py-3 text-base text-foreground placeholder:text-muted outline-none transition-[border-color,box-shadow] duration-150",a?"border-error":"border-border focus:border-accent focus:ring-3 focus:ring-accent/15",c),...e}));e.displayName="Input",a.s(["Input",0,e])},62475,a=>{"use strict";var b=a.i(63291),c=a.i(3252),d=a.i(41057);function e({postId:a,initialComments:e,userId:f}){let[g,h]=(0,c.useState)(e),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)("");async function q(b){if(b.preventDefault(),!i.trim()||k)return;l(!0);let c=await fetch(`/api/posts/${a}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:i.trim()})});if(c.ok){let a=await c.json();h(b=>[...b,a]),j("")}l(!1)}async function r(a){(await fetch(`/api/comments/${a}`,{method:"DELETE"})).ok&&h(b=>b.filter(b=>b.id!==a))}async function s(a){if(!o.trim())return;let b=await fetch(`/api/comments/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:o.trim()})});if(b.ok){let c=await b.json();h(b=>b.map(b=>b.id===a?{...b,...c}:b)),n(null),p("")}}return(0,b.jsxs)("div",{className:"border-t border-border",children:[(0,b.jsx)("div",{className:"flex flex-col",children:g.map(a=>(0,b.jsxs)("div",{className:"flex gap-3 border-b border-dashed border-muted/30 px-6 py-4",children:[(0,b.jsx)(d.default,{href:a.user?.username?`/u/${a.user.username}`:"#",children:a.user?.avatar_url?(0,b.jsx)("img",{src:a.user.avatar_url,alt:"",className:"h-6 w-6 rounded-full object-cover"}):(0,b.jsx)("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-foreground text-[10px] font-semibold text-background",children:a.user?.username?.[0]?.toUpperCase()??"?"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.default,{href:a.user?.username?`/u/${a.user.username}`:"#",className:"text-sm font-semibold hover:underline",children:a.user?.username??"anonymous"}),(0,b.jsx)("span",{className:"text-xs text-muted",children:function(a){let b=Math.floor((Date.now()-new Date(a).getTime())/6e4);if(b<1)return"just now";if(b<60)return`${b}m ago`;let c=Math.floor(b/60);if(c<24)return`${c}h ago`;let d=Math.floor(c/24);return`${d}d ago`}(a.created_at)})]}),m===a.id?(0,b.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,b.jsx)("input",{value:o,onChange:a=>p(a.target.value),maxLength:500,className:"flex-1 border border-border px-2 py-1 text-sm outline-none focus:border-accent",style:{borderRadius:4}}),(0,b.jsx)("button",{onClick:()=>s(a.id),className:"text-xs font-semibold text-accent hover:underline",children:"Save"}),(0,b.jsx)("button",{onClick:()=>n(null),className:"text-xs text-muted hover:underline",children:"Cancel"})]}):(0,b.jsx)("p",{className:"mt-0.5 text-sm",children:a.content}),f===a.user_id&&m!==a.id&&(0,b.jsxs)("div",{className:"mt-1 flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>{n(a.id),p(a.content)},className:"text-xs text-muted hover:text-foreground",children:"Edit"}),(0,b.jsx)("button",{onClick:()=>r(a.id),className:"text-xs text-muted hover:text-error",children:"Delete"})]})]})]},a.id))}),f&&(0,b.jsxs)("form",{onSubmit:q,className:"flex gap-3 px-6 py-4",children:[(0,b.jsx)("input",{value:i,onChange:a=>j(a.target.value),placeholder:"Add a comment...",maxLength:500,className:"flex-1 border border-border px-3 py-2 text-sm outline-none placeholder:text-muted focus:border-accent",style:{borderRadius:4}}),(0,b.jsx)("button",{type:"submit",disabled:!i.trim()||k,className:"bg-accent px-4 py-2 text-sm font-semibold text-white disabled:opacity-50",style:{borderRadius:4},children:k?"...":"Post"})]})]})}a.s(["CommentThread",()=>e])},86356,a=>{"use strict";var b=a.i(63291),c=a.i(3252),d=a.i(98170);let e=(0,d.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var f=a.i(23326);let g=(0,d.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),h=(0,d.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),i=(0,d.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var j=a.i(3288),k=a.i(72349),l=a.i(28546);function m({post:a}){let[d,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(a.title??""),[p,q]=(0,c.useState)(a.description??""),[r,s]=(0,c.useState)(a.images??[]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),x=(0,c.useRef)(null);async function y(){u(!0),(await fetch(`/api/posts/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n||null,description:p||null,images:r})})).ok&&(m(!1),window.location.reload()),u(!1)}async function z(){if(0===r.length)return;w(!0);let b=await fetch("/api/ai/generate-caption",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:r,usage:a.daily_usage?{costUSD:a.daily_usage.cost_usd,totalTokens:a.daily_usage.total_tokens,inputTokens:a.daily_usage.input_tokens,outputTokens:a.daily_usage.output_tokens,models:a.daily_usage.models,sessionCount:a.daily_usage.session_count}:null})});if(b.ok){let a=await b.json();o(a.title),q(a.description)}w(!1)}async function A(a){let b=a.target.files;if(!b)return;let c=4-r.length;for(let a of Array.from(b).slice(0,c)){let b=new FormData;b.append("file",a);let c=await fetch("/api/upload",{method:"POST",body:b});if(c.ok){let{url:a}=await c.json();s(b=>[...b,a])}}x.current&&(x.current.value="")}return d?(0,b.jsxs)("div",{className:"border-b border-border px-6 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-muted",children:"Edit Post"}),(0,b.jsx)("button",{onClick:()=>m(!1),className:"text-muted hover:text-foreground",children:(0,b.jsx)(f.X,{size:18})})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsx)(k.Input,{value:n,onChange:a=>o(a.target.value),placeholder:"Post title (optional)",maxLength:100}),(0,b.jsx)(l.Textarea,{value:p,onChange:a=>q(a.target.value),placeholder:"Describe what you built...",maxLength:500}),r.length>0&&(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:r.map((a,c)=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:a,alt:"",className:"h-20 w-20 rounded object-cover border border-border"}),(0,b.jsx)("button",{onClick:()=>{s(a=>a.filter((a,b)=>b!==c))},className:"absolute -top-1.5 -right-1.5 flex h-5 w-5 items-center justify-center rounded-full bg-foreground text-background text-xs",children:(0,b.jsx)(f.X,{size:12})})]},c))}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[r.length<4&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{ref:x,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",multiple:!0,onChange:A,className:"hidden"}),(0,b.jsxs)(j.Button,{variant:"secondary",size:"sm",onClick:()=>x.current?.click(),children:[(0,b.jsx)(h,{size:14,className:"mr-1.5"}),"Add images"]})]}),r.length>0&&(0,b.jsxs)(j.Button,{variant:"secondary",size:"sm",onClick:z,disabled:v,children:[v?(0,b.jsx)(i,{size:14,className:"mr-1.5 animate-spin"}):(0,b.jsx)(g,{size:14,className:"mr-1.5"}),v?"Generating...":"Generate caption"]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-1",children:[(0,b.jsx)(j.Button,{variant:"secondary",size:"sm",onClick:()=>m(!1),children:"Cancel"}),(0,b.jsx)(j.Button,{size:"sm",onClick:y,disabled:t,children:t?"Saving...":"Save changes"})]})]})]}):(0,b.jsx)("div",{className:"flex justify-end px-6 py-3 border-b border-dashed border-muted/30",children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>m(!0),children:[(0,b.jsx)(e,{size:14,className:"mr-1.5"}),"Edit post"]})})}a.s(["PostEditor",()=>m],86356)}];

//# sourceMappingURL=_24bcf71a._.js.map