{"version":3,"sources":["../../../../../../apps/web/components/ui/Avatar.tsx","../../../../../../apps/web/components/app/leaderboard/LeaderboardTable.tsx","../../../../../../apps/web/components/ui/Badge.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils/cn\";\n\ntype AvatarSize = \"xs\" | \"sm\" | \"md\" | \"lg\" | \"xl\";\n\ninterface AvatarProps {\n  src?: string | null;\n  alt?: string;\n  size?: AvatarSize;\n  fallback?: string;\n  className?: string;\n}\n\nconst sizeMap: Record<AvatarSize, { px: number; text: string }> = {\n  xs: { px: 24, text: \"text-[10px]\" },\n  sm: { px: 32, text: \"text-xs\" },\n  md: { px: 40, text: \"text-sm\" },\n  lg: { px: 80, text: \"text-xl\" },\n  xl: { px: 120, text: \"text-3xl\" },\n};\n\nfunction getInitials(name: string): string {\n  return name\n    .split(/\\s+/)\n    .slice(0, 2)\n    .map((s) => s[0]?.toUpperCase() ?? \"\")\n    .join(\"\");\n}\n\nexport function Avatar({ src, alt = \"\", size = \"md\", fallback, className }: AvatarProps) {\n  const { px, text } = sizeMap[size];\n  const initials = fallback ? getInitials(fallback) : \"?\";\n\n  if (src) {\n    return (\n      <img\n        src={src}\n        alt={alt}\n        width={px}\n        height={px}\n        className={cn(\n          \"rounded-full object-cover shrink-0\",\n          className,\n        )}\n        style={{ width: px, height: px }}\n      />\n    );\n  }\n\n  return (\n    <div\n      className={cn(\n        \"rounded-full bg-subtle text-muted flex items-center justify-center shrink-0 font-medium select-none\",\n        text,\n        className,\n      )}\n      style={{ width: px, height: px }}\n      aria-label={alt}\n    >\n      {initials}\n    </div>\n  );\n}\n","\"use client\";\n\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { cn } from \"@/lib/utils/cn\";\nimport { Avatar } from \"@/components/ui/Avatar\";\nimport { Badge } from \"@/components/ui/Badge\";\nimport type { LeaderboardEntry } from \"@/types\";\n\nconst PERIODS = [\n  { value: \"day\", label: \"Day\" },\n  { value: \"week\", label: \"Week\" },\n  { value: \"month\", label: \"Month\" },\n  { value: \"all_time\", label: \"All Time\" },\n];\n\nconst REGIONS = [\n  { value: \"\", label: \"Global\" },\n  { value: \"north_america\", label: \"N. America\" },\n  { value: \"south_america\", label: \"S. America\" },\n  { value: \"europe\", label: \"Europe\" },\n  { value: \"asia\", label: \"Asia\" },\n  { value: \"africa\", label: \"Africa\" },\n  { value: \"oceania\", label: \"Oceania\" },\n];\n\nfunction rankVariant(rank: number): \"rank-1\" | \"rank-2\" | \"rank-3\" | \"rank-top10\" | \"default\" {\n  if (rank === 1) return \"rank-1\";\n  if (rank === 2) return \"rank-2\";\n  if (rank === 3) return \"rank-3\";\n  if (rank <= 10) return \"rank-top10\";\n  return \"default\";\n}\n\nfunction formatTokens(n: number): string {\n  if (n >= 1_000_000) return `${(n / 1_000_000).toFixed(1)}M`;\n  if (n >= 1_000) return `${(n / 1_000).toFixed(1)}k`;\n  return String(n);\n}\n\nexport function LeaderboardTable({\n  entries,\n  currentUserId,\n  currentPeriod,\n  currentRegion,\n  userCountry,\n}: {\n  entries: LeaderboardEntry[];\n  currentUserId: string;\n  currentPeriod: string;\n  currentRegion: string | null;\n  userCountry: string | null;\n}) {\n  const router = useRouter();\n\n  function navigate(period: string, region: string) {\n    const params = new URLSearchParams();\n    params.set(\"period\", period);\n    if (region) params.set(\"region\", region);\n    router.push(`/leaderboard?${params.toString()}`);\n  }\n\n  return (\n    <div>\n      {/* Period tabs */}\n      <div className=\"flex border-b border-border\">\n        {PERIODS.map(({ value, label }) => (\n          <button\n            key={value}\n            onClick={() => navigate(value, currentRegion ?? \"\")}\n            className={cn(\n              \"cursor-pointer border-b-2 border-transparent px-5 py-3 text-sm font-semibold text-muted\",\n              currentPeriod === value && \"border-b-accent text-accent\",\n            )}\n          >\n            {label}\n          </button>\n        ))}\n      </div>\n\n      {/* Region filter */}\n      {userCountry && (\n        <div className=\"flex gap-1 overflow-x-auto border-b border-border px-4 py-2\">\n          {REGIONS.map(({ value, label }) => (\n            <button\n              key={value}\n              onClick={() => navigate(currentPeriod, value)}\n              className={cn(\n                \"shrink-0 cursor-pointer rounded-[4px] px-3 py-1 text-xs font-semibold\",\n                (currentRegion ?? \"\") === value\n                  ? \"bg-foreground text-background\"\n                  : \"text-muted hover:text-foreground\",\n              )}\n            >\n              {label}\n            </button>\n          ))}\n        </div>\n      )}\n\n      {/* Desktop table */}\n      <div className=\"hidden overflow-x-auto sm:block\">\n        <table className=\"w-full text-left text-sm\">\n          <thead>\n            <tr className=\"border-b border-border text-xs uppercase tracking-widest text-muted\">\n              <th className=\"px-6 py-3 font-semibold\">Rank</th>\n              <th className=\"px-6 py-3 font-semibold\">User</th>\n              <th className=\"px-6 py-3 text-right font-semibold\">Cost</th>\n              <th className=\"px-6 py-3 text-right font-semibold\">Tokens</th>\n              <th className=\"px-6 py-3 text-right font-semibold\">Streak</th>\n            </tr>\n          </thead>\n          <tbody>\n            {entries.map((entry) => (\n              <tr\n                key={entry.user_id}\n                className={cn(\n                  \"border-b border-border hover:bg-subtle\",\n                  entry.user_id === currentUserId &&\n                    \"border-l-4 border-l-accent bg-highlight-row\",\n                )}\n              >\n                <td className=\"px-6 py-3\">\n                  <Badge variant={rankVariant(entry.rank)}>{entry.rank}</Badge>\n                </td>\n                <td className=\"px-6 py-3\">\n                  <Link\n                    href={`/u/${entry.username}`}\n                    className=\"flex items-center gap-3 hover:underline\"\n                  >\n                    <Avatar\n                      src={entry.avatar_url}\n                      alt={entry.username}\n                      fallback={entry.username}\n                      size=\"sm\"\n                    />\n                    <span className=\"font-medium\">{entry.username}</span>\n                    {entry.country && (\n                      <span className=\"text-xs text-muted\">{entry.country}</span>\n                    )}\n                  </Link>\n                </td>\n                <td className=\"px-6 py-3 text-right font-mono font-medium tabular-nums text-accent\">\n                  ${entry.total_cost.toFixed(2)}\n                </td>\n                <td className=\"px-6 py-3 text-right font-mono tabular-nums\">\n                  {formatTokens(entry.total_tokens)}\n                </td>\n                <td className=\"px-6 py-3 text-right font-mono tabular-nums\">\n                  {entry.streak != null ? `${entry.streak}d` : \"-\"}\n                </td>\n              </tr>\n            ))}\n            {entries.length === 0 && (\n              <tr>\n                <td colSpan={5} className=\"px-6 py-12 text-center text-muted\">\n                  No entries yet.\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Mobile card list */}\n      <div className=\"sm:hidden\">\n        {entries.map((entry) => (\n          <Link\n            key={entry.user_id}\n            href={`/u/${entry.username}`}\n            className={cn(\n              \"flex items-center gap-3 border-b border-border px-4 py-3 hover:bg-subtle\",\n              entry.user_id === currentUserId &&\n                \"border-l-4 border-l-accent bg-highlight-row\",\n            )}\n          >\n            <Badge variant={rankVariant(entry.rank)}>{entry.rank}</Badge>\n            <Avatar\n              src={entry.avatar_url}\n              alt={entry.username}\n              fallback={entry.username}\n              size=\"sm\"\n            />\n            <div className=\"flex-1 overflow-hidden\">\n              <p className=\"truncate font-medium\">{entry.username}</p>\n              {entry.country && (\n                <p className=\"text-xs text-muted\">{entry.country}</p>\n              )}\n            </div>\n            <div className=\"text-right\">\n              <p className=\"font-mono text-sm font-medium tabular-nums text-accent\">\n                ${entry.total_cost.toFixed(2)}\n              </p>\n              <p className=\"font-mono text-xs tabular-nums text-muted\">\n                {formatTokens(entry.total_tokens)}\n              </p>\n            </div>\n          </Link>\n        ))}\n        {entries.length === 0 && (\n          <p className=\"px-6 py-12 text-center text-muted\">No entries yet.</p>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { cn } from \"@/lib/utils/cn\";\n\ntype BadgeVariant = \"default\" | \"accent\" | \"verified\" | \"rank-1\" | \"rank-2\" | \"rank-3\" | \"rank-top10\";\n\ninterface BadgeProps {\n  variant?: BadgeVariant;\n  className?: string;\n  children: React.ReactNode;\n}\n\nconst variantStyles: Record<BadgeVariant, string> = {\n  default: \"bg-subtle text-foreground\",\n  accent: \"bg-accent text-white\",\n  verified: \"text-accent\",\n  \"rank-1\": \"text-white\",\n  \"rank-2\": \"text-foreground\",\n  \"rank-3\": \"text-white\",\n  \"rank-top10\": \"bg-accent text-white\",\n};\n\nexport function Badge({ variant = \"default\", className, children }: BadgeProps) {\n  const isRank = variant.startsWith(\"rank-\");\n\n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center gap-1 rounded-[4px] px-2 py-0.5 text-xs font-semibold leading-tight\",\n        variantStyles[variant],\n        isRank && variant === \"rank-1\" && \"bg-linear-to-br from-[#FFD700] to-[#FFA500]\",\n        isRank && variant === \"rank-2\" && \"bg-linear-to-br from-[#E8E8E8] to-[#C0C0C0]\",\n        isRank && variant === \"rank-3\" && \"bg-linear-to-br from-[#DDA15E] to-[#BC6C25]\",\n        className,\n      )}\n    >\n      {children}\n    </span>\n  );\n}\n"],"names":[],"mappings":"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"}