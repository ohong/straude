{"version":3,"sources":["../../../../../../apps/web/components/ui/Button.tsx","../../../../../../apps/web/components/ui/Textarea.tsx","../../../../../../apps/web/app/%28app%29/settings/import/page.tsx"],"sourcesContent":["import { forwardRef, type ButtonHTMLAttributes } from \"react\";\nimport { cn } from \"@/lib/utils/cn\";\n\ntype ButtonVariant = \"primary\" | \"secondary\" | \"ghost\";\ntype ButtonSize = \"sm\" | \"md\" | \"lg\";\n\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: ButtonVariant;\n  size?: ButtonSize;\n}\n\nconst variantStyles: Record<ButtonVariant, string> = {\n  primary:\n    \"bg-accent text-white border-none hover:brightness-90 active:brightness-85 disabled:opacity-50\",\n  secondary:\n    \"bg-transparent text-foreground border border-border hover:bg-subtle disabled:opacity-50\",\n  ghost:\n    \"bg-transparent text-foreground border-none hover:text-accent disabled:opacity-50\",\n};\n\nconst sizeStyles: Record<ButtonSize, string> = {\n  sm: \"px-3 py-1.5 text-xs\",\n  md: \"px-4 py-2 text-sm\",\n  lg: \"px-6 py-3 text-base\",\n};\n\nexport const Button = forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ variant = \"primary\", size = \"md\", className, ...props }, ref) => {\n    return (\n      <button\n        ref={ref}\n        className={cn(\n          \"inline-flex items-center justify-center rounded-[4px] font-semibold cursor-pointer transition-[filter,background-color,color] duration-150\",\n          variantStyles[variant],\n          sizeStyles[size],\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\n\nButton.displayName = \"Button\";\n","import { forwardRef, type TextareaHTMLAttributes } from \"react\";\nimport { cn } from \"@/lib/utils/cn\";\n\ninterface TextareaProps extends TextareaHTMLAttributes<HTMLTextAreaElement> {\n  error?: boolean;\n}\n\nexport const Textarea = forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ error, className, ...props }, ref) => {\n    return (\n      <textarea\n        ref={ref}\n        className={cn(\n          \"w-full rounded-[4px] border bg-white px-4 py-3 text-base text-foreground placeholder:text-muted outline-none transition-[border-color,box-shadow] duration-150 resize-y min-h-[100px]\",\n          error\n            ? \"border-error\"\n            : \"border-border focus:border-accent focus:ring-3 focus:ring-accent/15\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\n\nTextarea.displayName = \"Textarea\";\n","\"use client\";\n\nimport { useState } from \"react\";\nimport { Textarea } from \"@/components/ui/Textarea\";\nimport { Button } from \"@/components/ui/Button\";\n\ninterface ImportResult {\n  date: string;\n  usage_id: string;\n  post_id: string;\n  post_url: string;\n}\n\nexport default function ImportPage() {\n  const [json, setJson] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [results, setResults] = useState<ImportResult[] | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setResults(null);\n\n    let parsed: unknown;\n    try {\n      parsed = JSON.parse(json);\n    } catch {\n      setError(\"Invalid JSON. Please paste the output of: ccusage daily --json\");\n      setLoading(false);\n      return;\n    }\n\n    const obj = parsed as { type?: string; data?: unknown[] };\n    if (obj.type !== \"daily\" || !Array.isArray(obj.data)) {\n      setError(\n        'Expected ccusage output with { \"type\": \"daily\", \"data\": [...] }. Make sure you run: ccusage daily --json',\n      );\n      setLoading(false);\n      return;\n    }\n\n    const entries = (obj.data as Record<string, unknown>[]).map((d) => ({\n      date: d.date as string,\n      data: {\n        date: d.date as string,\n        models: (d.models as string[]) ?? [],\n        inputTokens: (d.inputTokens as number) ?? 0,\n        outputTokens: (d.outputTokens as number) ?? 0,\n        cacheCreationTokens: (d.cacheCreationTokens as number) ?? 0,\n        cacheReadTokens: (d.cacheReadTokens as number) ?? 0,\n        totalTokens: (d.totalTokens as number) ?? 0,\n        costUSD: (d.costUSD as number) ?? 0,\n      },\n    }));\n\n    const res = await fetch(\"/api/usage/submit\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ entries, source: \"web\" }),\n    });\n\n    if (!res.ok) {\n      const body = await res.json();\n      setError(body.error ?? \"Import failed\");\n    } else {\n      const body = await res.json();\n      setResults(body.results);\n    }\n    setLoading(false);\n  }\n\n  return (\n    <>\n      <header className=\"sticky top-0 z-10 flex h-16 items-center border-b border-border bg-background px-6\">\n        <h3 className=\"text-lg font-medium\">Import Usage Data</h3>\n      </header>\n\n      <div className=\"mx-auto max-w-lg px-6 py-8\">\n        <div className=\"mb-6 border-l-2 border-l-accent bg-subtle p-4\">\n          <p className=\"text-sm\">Run this command to get your usage data:</p>\n          <pre className=\"mt-2 overflow-x-auto font-mono text-sm\">\n            ccusage daily --json --since YYYYMMDD --until YYYYMMDD\n          </pre>\n          <p className=\"mt-2 text-xs text-muted\">\n            Paste the JSON output below. Data will be marked as unverified (use the CLI for verified\n            posts).\n          </p>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <Textarea\n            value={json}\n            onChange={(e) => setJson(e.target.value)}\n            placeholder='{\"type\":\"daily\",\"data\":[...],\"summary\":{...}}'\n            rows={12}\n            className=\"font-mono text-sm\"\n          />\n\n          {error && <p className=\"text-sm text-error\">{error}</p>}\n\n          {results && (\n            <div className=\"border border-border p-4\">\n              <p className=\"text-sm font-medium\">\n                Imported {results.length} {results.length === 1 ? \"day\" : \"days\"} of data.\n              </p>\n              <ul className=\"mt-2 space-y-1\">\n                {results.map((r) => (\n                  <li key={r.date} className=\"text-xs text-muted\">\n                    {r.date} &mdash;{\" \"}\n                    <a href={r.post_url} className=\"text-accent hover:underline\">\n                      View post\n                    </a>\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          <Button type=\"submit\" disabled={loading || !json.trim()} className=\"w-full py-3\">\n            {loading ? \"Importing...\" : \"Import Data\"}\n          </Button>\n        </form>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}