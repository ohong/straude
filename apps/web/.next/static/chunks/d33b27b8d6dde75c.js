(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67337,e=>{"use strict";let t=(0,e.i(88391).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],67337)},64720,e=>{"use strict";var t=e.i(19097),a=e.i(42947),s=e.i(77255);let r={primary:"bg-accent text-white border-none hover:brightness-90 active:brightness-85 disabled:opacity-50",secondary:"bg-transparent text-foreground border border-border hover:bg-subtle disabled:opacity-50",ghost:"bg-transparent text-foreground border-none hover:text-accent disabled:opacity-50"},n={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},i=(0,a.forwardRef)(({variant:e="primary",size:a="md",className:i,...o},l)=>(0,t.jsx)("button",{ref:l,className:(0,s.cn)("inline-flex items-center justify-center rounded-[4px] font-semibold cursor-pointer transition-[filter,background-color,color] duration-150",r[e],n[a],i),...o}));i.displayName="Button",e.s(["Button",0,i])},76444,e=>{"use strict";var t=e.i(19097),a=e.i(42947),s=e.i(77255);let r=(0,a.forwardRef)(({error:e,className:a,...r},n)=>(0,t.jsx)("textarea",{ref:n,className:(0,s.cn)("w-full rounded-[4px] border bg-white px-4 py-3 text-base text-foreground placeholder:text-muted outline-none transition-[border-color,box-shadow] duration-150 resize-y min-h-[100px]",e?"border-error":"border-border focus:border-accent focus:ring-3 focus:ring-accent/15",a),...r}));r.displayName="Textarea",e.s(["Textarea",0,r])},99760,e=>{"use strict";var t=e.i(19097),a=e.i(42947),s=e.i(77255);let r=(0,a.forwardRef)(({error:e,className:a,...r},n)=>(0,t.jsx)("input",{ref:n,className:(0,s.cn)("w-full rounded-[4px] border bg-white px-4 py-3 text-base text-foreground placeholder:text-muted outline-none transition-[border-color,box-shadow] duration-150",e?"border-error":"border-border focus:border-accent focus:ring-3 focus:ring-accent/15",a),...r}));r.displayName="Input",e.s(["Input",0,r])},49073,e=>{"use strict";var t=e.i(19097),a=e.i(42947),s=e.i(62030);function r({postId:e,initialComments:r,userId:n}){let[i,o]=(0,a.useState)(r),[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),[p,h]=(0,a.useState)("");async function f(t){if(t.preventDefault(),!l.trim()||c)return;u(!0);let a=await fetch(`/api/posts/${e}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:l.trim()})});if(a.ok){let e=await a.json();o(t=>[...t,e]),d("")}u(!1)}async function b(e){(await fetch(`/api/comments/${e}`,{method:"DELETE"})).ok&&o(t=>t.filter(t=>t.id!==e))}async function g(e){if(!p.trim())return;let t=await fetch(`/api/comments/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:p.trim()})});if(t.ok){let a=await t.json();o(t=>t.map(t=>t.id===e?{...t,...a}:t)),x(null),h("")}}return(0,t.jsxs)("div",{className:"border-t border-border",children:[(0,t.jsx)("div",{className:"flex flex-col",children:i.map(e=>(0,t.jsxs)("div",{className:"flex gap-3 border-b border-dashed border-muted/30 px-6 py-4",children:[(0,t.jsx)(s.default,{href:e.user?.username?`/u/${e.user.username}`:"#",children:e.user?.avatar_url?(0,t.jsx)("img",{src:e.user.avatar_url,alt:"",className:"h-6 w-6 rounded-full object-cover"}):(0,t.jsx)("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-foreground text-[10px] font-semibold text-background",children:e.user?.username?.[0]?.toUpperCase()??"?"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s.default,{href:e.user?.username?`/u/${e.user.username}`:"#",className:"text-sm font-semibold hover:underline",children:e.user?.username??"anonymous"}),(0,t.jsx)("span",{className:"text-xs text-muted",children:function(e){let t=Math.floor((Date.now()-new Date(e).getTime())/6e4);if(t<1)return"just now";if(t<60)return`${t}m ago`;let a=Math.floor(t/60);if(a<24)return`${a}h ago`;let s=Math.floor(a/24);return`${s}d ago`}(e.created_at)})]}),m===e.id?(0,t.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,t.jsx)("input",{value:p,onChange:e=>h(e.target.value),maxLength:500,className:"flex-1 border border-border px-2 py-1 text-sm outline-none focus:border-accent",style:{borderRadius:4}}),(0,t.jsx)("button",{onClick:()=>g(e.id),className:"text-xs font-semibold text-accent hover:underline",children:"Save"}),(0,t.jsx)("button",{onClick:()=>x(null),className:"text-xs text-muted hover:underline",children:"Cancel"})]}):(0,t.jsx)("p",{className:"mt-0.5 text-sm",children:e.content}),n===e.user_id&&m!==e.id&&(0,t.jsxs)("div",{className:"mt-1 flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>{x(e.id),h(e.content)},className:"text-xs text-muted hover:text-foreground",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>b(e.id),className:"text-xs text-muted hover:text-error",children:"Delete"})]})]})]},e.id))}),n&&(0,t.jsxs)("form",{onSubmit:f,className:"flex gap-3 px-6 py-4",children:[(0,t.jsx)("input",{value:l,onChange:e=>d(e.target.value),placeholder:"Add a comment...",maxLength:500,className:"flex-1 border border-border px-3 py-2 text-sm outline-none placeholder:text-muted focus:border-accent",style:{borderRadius:4}}),(0,t.jsx)("button",{type:"submit",disabled:!l.trim()||c,className:"bg-accent px-4 py-2 text-sm font-semibold text-white disabled:opacity-50",style:{borderRadius:4},children:c?"...":"Post"})]})]})}e.s(["CommentThread",()=>r])},70380,e=>{"use strict";var t=e.i(19097),a=e.i(42947),s=e.i(88391);let r=(0,s.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var n=e.i(67337);let i=(0,s.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),o=(0,s.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),l=(0,s.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var d=e.i(64720),c=e.i(99760),u=e.i(76444);function m({post:e}){let[s,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(e.title??""),[h,f]=(0,a.useState)(e.description??""),[b,g]=(0,a.useState)(e.images??[]),[y,j]=(0,a.useState)(!1),[v,N]=(0,a.useState)(!1),k=(0,a.useRef)(null);async function w(){j(!0),(await fetch(`/api/posts/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:x||null,description:h||null,images:b})})).ok&&(m(!1),window.location.reload()),j(!1)}async function C(){if(0===b.length)return;N(!0);let t=await fetch("/api/ai/generate-caption",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:b,usage:e.daily_usage?{costUSD:e.daily_usage.cost_usd,totalTokens:e.daily_usage.total_tokens,inputTokens:e.daily_usage.input_tokens,outputTokens:e.daily_usage.output_tokens,models:e.daily_usage.models,sessionCount:e.daily_usage.session_count}:null})});if(t.ok){let e=await t.json();p(e.title),f(e.description)}N(!1)}async function S(e){let t=e.target.files;if(!t)return;let a=4-b.length;for(let e of Array.from(t).slice(0,a)){let t=new FormData;t.append("file",e);let a=await fetch("/api/upload",{method:"POST",body:t});if(a.ok){let{url:e}=await a.json();g(t=>[...t,e])}}k.current&&(k.current.value="")}return s?(0,t.jsxs)("div",{className:"border-b border-border px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-muted",children:"Edit Post"}),(0,t.jsx)("button",{onClick:()=>m(!1),className:"text-muted hover:text-foreground",children:(0,t.jsx)(n.X,{size:18})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)(c.Input,{value:x,onChange:e=>p(e.target.value),placeholder:"Post title (optional)",maxLength:100}),(0,t.jsx)(u.Textarea,{value:h,onChange:e=>f(e.target.value),placeholder:"Describe what you built...",maxLength:500}),b.length>0&&(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:b.map((e,a)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:e,alt:"",className:"h-20 w-20 rounded object-cover border border-border"}),(0,t.jsx)("button",{onClick:()=>{g(e=>e.filter((e,t)=>t!==a))},className:"absolute -top-1.5 -right-1.5 flex h-5 w-5 items-center justify-center rounded-full bg-foreground text-background text-xs",children:(0,t.jsx)(n.X,{size:12})})]},a))}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[b.length<4&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{ref:k,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",multiple:!0,onChange:S,className:"hidden"}),(0,t.jsxs)(d.Button,{variant:"secondary",size:"sm",onClick:()=>k.current?.click(),children:[(0,t.jsx)(o,{size:14,className:"mr-1.5"}),"Add images"]})]}),b.length>0&&(0,t.jsxs)(d.Button,{variant:"secondary",size:"sm",onClick:C,disabled:v,children:[v?(0,t.jsx)(l,{size:14,className:"mr-1.5 animate-spin"}):(0,t.jsx)(i,{size:14,className:"mr-1.5"}),v?"Generating...":"Generate caption"]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-1",children:[(0,t.jsx)(d.Button,{variant:"secondary",size:"sm",onClick:()=>m(!1),children:"Cancel"}),(0,t.jsx)(d.Button,{size:"sm",onClick:w,disabled:y,children:y?"Saving...":"Save changes"})]})]})]}):(0,t.jsx)("div",{className:"flex justify-end px-6 py-3 border-b border-dashed border-muted/30",children:(0,t.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:()=>m(!0),children:[(0,t.jsx)(r,{size:14,className:"mr-1.5"}),"Edit post"]})})}e.s(["PostEditor",()=>m],70380)}]);